# VSCode 配置

本项目包含了完整的 VSCode 配置，为团队提供统一的开发环境。

## 配置文件

### .vscode/settings.json

项目级别的 VSCode 编辑器设置，只包含必要的 VSCode 特有配置。

> **注意**：缩进、换行符、行尾空格等基础编码规范由 `.editorconfig` 统一管理，此文件不重复配置。

#### 配置内容

```json
{
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": "explicit"
  },

  "eslint.useFlatConfig": true,
  "prettier.requireConfig": true,
  "typescript.tsdk": "node_modules/typescript/lib"
}
```

#### 配置说明

**编辑器格式化**

- `editor.formatOnSave`: 保存时自动格式化代码
- `editor.defaultFormatter`: 使用 Prettier 作为默认格式化工具
- `editor.codeActionsOnSave.source.fixAll.eslint`: 保存时自动修复 ESLint 问题

**工具配置**

- `eslint.useFlatConfig`: 使用 ESLint v9 Flat Config 格式
- `prettier.requireConfig`: 要求项目必须有 Prettier 配置文件（确保使用 `.prettierrc.yaml`）
- `typescript.tsdk`: 使用项目本地的 TypeScript 版本（确保团队版本一致）

### .vscode/extensions.json

推荐安装的 VSCode 扩展列表。

#### 推荐扩展

1. **dbaeumer.vscode-eslint**
   - ESLint 官方扩展
   - 提供实时代码检查和自动修复

2. **esbenp.prettier-vscode**
   - Prettier 官方扩展
   - 代码格式化工具

3. **editorconfig.editorconfig**
   - EditorConfig 支持
   - 跨编辑器统一编码规范

4. **ms-vscode.vscode-typescript-next**
   - TypeScript 最新特性支持
   - 更好的类型检查和智能提示

5. **redhat.vscode-yaml**
   - YAML 文件支持
   - 语法高亮和验证

### .editorconfig

跨编辑器的编码规范配置文件，确保团队成员使用不同编辑器时也能保持一致的编码风格。

#### 配置文件

```ini
root = true

[*]
charset = utf-8
end_of_line = lf
indent_style = space
indent_size = 2
insert_final_newline = true
trim_trailing_whitespace = true

[*.md]
trim_trailing_whitespace = false
```

#### 配置说明

**通用配置 `[*]`**

- `root = true`: 顶层配置文件，停止向上查找
- `charset = utf-8`: 字符编码设为 UTF-8
- `end_of_line = lf`: 使用 LF (Unix 风格) 换行符
- `indent_style = space`: 使用空格进行缩进
- `indent_size = 2`: 缩进大小为 2 个空格
- `insert_final_newline = true`: 在文件末尾插入空行
- `trim_trailing_whitespace = true`: 自动删除行尾空格

**Markdown 特殊配置 `[*.md]`**

- `trim_trailing_whitespace = false`: 保留行尾空格（Markdown 中两个空格表示换行）

#### 支持的编辑器

EditorConfig 被以下编辑器原生支持或通过插件支持：

- VSCode (通过 EditorConfig 扩展)
- IntelliJ IDEA / WebStorm
- Sublime Text
- Atom
- Vim
- Emacs

## 工作流集成

### 保存时自动处理

当保存文件时，VSCode 会自动执行：

1. **ESLint 自动修复**: 修复可自动修复的 ESLint 问题
2. **Prettier 格式化**: 根据 `.prettierrc.yaml` 格式化代码
3. **EditorConfig 应用**: 应用缩进、换行符、行尾空格等规范

### 配置职责分离

- **`.editorconfig`**: 基础编码规范（缩进、换行符、字符编码等）
- **`.vscode/settings.json`**: VSCode 特有功能（格式化、Linting、TypeScript 等）
- **`.prettierrc.yaml`**: Prettier 格式化规则
- **`eslint.config.js`**: ESLint 代码检查规则

### 配合 Git Hooks

VSCode 的自动处理配合 Git Hooks 形成多层保障：

- **开发时**: VSCode 自动格式化和修复（保存时）
- **提交前**: `pre-commit` hook 运行 lint-staged 检查暂存文件
- **提交时**: `commit-msg` hook 验证提交信息格式

### 推荐工作流

```bash
# 1. 修改代码
# 2. Cmd+S 保存（VSCode 自动格式化和修复）
# 3. git add .
# 4. pnpm run commit（使用 Commitizen 创建规范提交）
```

## 参考资料

- [EditorConfig](https://editorconfig.org/)
- [ESLint VSCode Extension](https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint)
- [Prettier VSCode Extension](https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode)
- [TypeScript VSCode Extension](https://marketplace.visualstudio.com/items?itemName=ms-vscode.vscode-typescript-next)
